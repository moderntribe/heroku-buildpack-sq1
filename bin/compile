#!/usr/bin/env bash

set -e            # fail fast
set -o pipefail   # don't ignore exit codes when piping output
# set -x          # enable debugging

echo "-----> Found a squareone.yaml"

# Configure directories
BUILD_DIR=$1

cd $BUILD_DIR

# Install WP CLI
curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
chmod +x wp-cli.phar
mkdir /app/.heroku/wp/bin
mv wp-cli.phar /app/.heroku/wp/bin/wp
export PATH="/app/.heroku/wp/bin/:$PATH"

# Export PHP path to bin
export PATH="/app/.heroku/php/bin:$PATH"
